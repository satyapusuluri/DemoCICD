/**
 * Name: APTSMD_SendToEchoSignHandler
 * Description: This class will be used for send signature using echosign for mass amendment
 * Author: Japan Bhavsar
 * Created Date: 2/14/2019
**/
global class APTSMD_SendToEchoSignHandler {
    
    // sendForEchoSignHelper() - This method will be used as helper class
    public static void sendForEchoSignHelper(Apttus__APTS_Agreement__c agmt, Attachment attchMnt){
        
        sObjectType st = agmt.Id.getSObjectType();  
        String sType = String.valueOf(st);
        
        // Create an echosign agreement
        echosign_dev1__SIGN_Agreement__c esAgmt = new echosign_dev1__SIGN_Agreement__c();
        esAgmt.Name = agmt.Name;
        esAgmt.echosign_dev1__SignatureType__c = 'e-Signature';
        esAgmt.echosign_dev1__SignatureOrder__c = null;
        esAgmt.echosign_dev1__Recipient__c = agmt.Apttus__Primary_Contact__c;
        esAgmt.echosign_dev1__Message__c = 'Please sign attached document.';
       
        if(sType=='Apttus_Proposal__Proposal__c'){
            esAgmt.Apttus_Proposal__c = agmt.Id;
        }
        else{
            esAgmt.Apttus_Echosign__Apttus_Agreement__c = agmt.Id;
        }
        
        PageReference rtnPageRef = new PageReference('/' + agmt.Id);
        esAgmt.echosign_dev1__ReturnURL__c = rtnPageRef.getUrl();
        
        // Insert agreement
        insert esAgmt;
        
        // clone and associate selected attachments to echosign agreement.
        Attachment echoSignAttachment = cloneAttachments(attchMnt, esAgmt.Id);
                        
        // update esAgmt with attachmentIds for ordering
        esAgmt.echosign_dev1__Attachment_ID_Order__c = echoSignAttachment.Id;
        update esAgmt;
        
        // Update agreement status (Has to blank or change the status becuase we did not then it will fire trigger again)
        agmt.APTSMD_Sign_or_Review__c = '';
        update agmt;
        
        // Now Call API
        echosign_dev1.EchoSignApiService.SendDocumentResult result = echosign_dev1.EchoSignApiService.SendDocumentResult.sendDocument(esAgmt.Id);
        System.debug('result :'+result);

    }
    
    // cloneAttachments() - Used for clonning the attachment for echosign agreement
    private static Attachment cloneAttachments(Attachment attchmnt, ID parentId) {
        List<Attachment> eSignAttachmentList = new List<Attachment>();
        
        Attachment esAttachment = new Attachment(Name = attchmnt.Name
        , ContentType = attchmnt.ContentType
        , Body = attchmnt.Body
        , ParentId = parentId);
        eSignAttachmentList.add(esAttachment);
        
        insert eSignAttachmentList;
        return eSignAttachmentList[0];
    }   
    

    // sendForEchoSign() - This remote method used for sending for echosign (Do not use this method as it will give an error while calling api from this future method)
    // @Future(callout=true)
    // public static void sendForEchoSign(String esAgmtId){
    //     echosign_dev1.EchoSignApiService.SendDocumentResult result = echosign_dev1.EchoSignApiService.SendDocumentResult.sendDocument(esAgmtId);
    //     System.debug('result :'+result);
    // }
    
    // getMIMEType() - This function will be used to getting MIME Type for file extension
    public static string getMIMEType(string fileExt){
        Map<string, string> mapOfExtVsMIME = new Map<string, string>();
            mapOfExtVsMIME.put('.3g2', 'video/3gpp2');
            mapOfExtVsMIME.put('.3gp', 'video/3gpp');
            mapOfExtVsMIME.put('.3gp2', 'video/3gpp2');
            mapOfExtVsMIME.put('.3gpp', 'video/3gpp');
            mapOfExtVsMIME.put('.7z', 'application/x-7z-compressed');
            mapOfExtVsMIME.put('.aa', 'audio/audible');
            mapOfExtVsMIME.put('.AAC', 'audio/aac');
            mapOfExtVsMIME.put('.aaf', 'application/octet-stream');
            mapOfExtVsMIME.put('.aax', 'audio/vnd.audible.aax');
            mapOfExtVsMIME.put('.ac3', 'audio/ac3');
            mapOfExtVsMIME.put('.aca', 'application/octet-stream');
            mapOfExtVsMIME.put('.accda', 'application/msaccess.addin');
            mapOfExtVsMIME.put('.accdb', 'application/msaccess');
            mapOfExtVsMIME.put('.accdc', 'application/msaccess.cab');
            mapOfExtVsMIME.put('.accde', 'application/msaccess');
            mapOfExtVsMIME.put('.accdr', 'application/msaccess.runtime');
            mapOfExtVsMIME.put('.accdt', 'application/msaccess');
            mapOfExtVsMIME.put('.accdw', 'application/msaccess.webapplication');
            mapOfExtVsMIME.put('.accft', 'application/msaccess.ftemplate');
            mapOfExtVsMIME.put('.acx', 'application/internet-property-stream');
            mapOfExtVsMIME.put('.AddIn', 'text/xml');
            mapOfExtVsMIME.put('.ade', 'application/msaccess');
            mapOfExtVsMIME.put('.adobebridge', 'application/x-bridge-url');
            mapOfExtVsMIME.put('.adp', 'application/msaccess');
            mapOfExtVsMIME.put('.ADT', 'audio/vnd.dlna.adts');
            mapOfExtVsMIME.put('.ADTS', 'audio/aac');
            mapOfExtVsMIME.put('.afm', 'application/octet-stream');
            mapOfExtVsMIME.put('.ai', 'application/postscript');
            mapOfExtVsMIME.put('.aif', 'audio/aiff');
            mapOfExtVsMIME.put('.aifc', 'audio/aiff');
            mapOfExtVsMIME.put('.aiff', 'audio/aiff');
            mapOfExtVsMIME.put('.air', 'application/vnd.adobe.air-application-installer-package+zip');
            mapOfExtVsMIME.put('.amc', 'application/mpeg');
            mapOfExtVsMIME.put('.anx', 'application/annodex');
            mapOfExtVsMIME.put('.apk', 'application/vnd.android.package-archive');
            mapOfExtVsMIME.put('.application', 'application/x-ms-application');
            mapOfExtVsMIME.put('.art', 'image/x-jg');
            mapOfExtVsMIME.put('.asa', 'application/xml');
            mapOfExtVsMIME.put('.asax', 'application/xml');
            mapOfExtVsMIME.put('.ascx', 'application/xml');
            mapOfExtVsMIME.put('.asd', 'application/octet-stream');
            mapOfExtVsMIME.put('.asf', 'video/x-ms-asf');
            mapOfExtVsMIME.put('.ashx', 'application/xml');
            mapOfExtVsMIME.put('.asi', 'application/octet-stream');
            mapOfExtVsMIME.put('.asm', 'text/plain');
            mapOfExtVsMIME.put('.asmx', 'application/xml');
            mapOfExtVsMIME.put('.aspx', 'application/xml');
            mapOfExtVsMIME.put('.asr', 'video/x-ms-asf');
            mapOfExtVsMIME.put('.asx', 'video/x-ms-asf');
            mapOfExtVsMIME.put('.atom', 'application/atom+xml');
            mapOfExtVsMIME.put('.au', 'audio/basic');
            mapOfExtVsMIME.put('.avi', 'video/x-msvideo');
            mapOfExtVsMIME.put('.axa', 'audio/annodex');
            mapOfExtVsMIME.put('.axs', 'application/olescript');
            mapOfExtVsMIME.put('.axv', 'video/annodex');
            mapOfExtVsMIME.put('.bas', 'text/plain');
            mapOfExtVsMIME.put('.bcpio', 'application/x-bcpio');
            mapOfExtVsMIME.put('.bin', 'application/octet-stream');
            mapOfExtVsMIME.put('.bmp', 'image/bmp');
            mapOfExtVsMIME.put('.c', 'text/plain');
            mapOfExtVsMIME.put('.cab', 'application/octet-stream');
            mapOfExtVsMIME.put('.caf', 'audio/x-caf');
            mapOfExtVsMIME.put('.calx', 'application/vnd.ms-office.calx');
            mapOfExtVsMIME.put('.cat', 'application/vnd.ms-pki.seccat');
            mapOfExtVsMIME.put('.cc', 'text/plain');
            mapOfExtVsMIME.put('.cd', 'text/plain');
            mapOfExtVsMIME.put('.cdda', 'audio/aiff');
            mapOfExtVsMIME.put('.cdf', 'application/x-cdf');
            mapOfExtVsMIME.put('.cer', 'application/x-x509-ca-cert');
            mapOfExtVsMIME.put('.cfg', 'text/plain');
            mapOfExtVsMIME.put('.chm', 'application/octet-stream');
            mapOfExtVsMIME.put('.class', 'application/x-java-applet');
            mapOfExtVsMIME.put('.clp', 'application/x-msclip');
            mapOfExtVsMIME.put('.cmd', 'text/plain');
            mapOfExtVsMIME.put('.cmx', 'image/x-cmx');
            mapOfExtVsMIME.put('.cnf', 'text/plain');
            mapOfExtVsMIME.put('.cod', 'image/cis-cod');
            mapOfExtVsMIME.put('.config', 'application/xml');
            mapOfExtVsMIME.put('.contact', 'text/x-ms-contact');
            mapOfExtVsMIME.put('.coverage', 'application/xml');
            mapOfExtVsMIME.put('.cpio', 'application/x-cpio');
            mapOfExtVsMIME.put('.cpp', 'text/plain');
            mapOfExtVsMIME.put('.crd', 'application/x-mscardfile');
            mapOfExtVsMIME.put('.crl', 'application/pkix-crl');
            mapOfExtVsMIME.put('.crt', 'application/x-x509-ca-cert');
            mapOfExtVsMIME.put('.cs', 'text/plain');
            mapOfExtVsMIME.put('.csdproj', 'text/plain');
            mapOfExtVsMIME.put('.csh', 'application/x-csh');
            mapOfExtVsMIME.put('.csproj', 'text/plain');
            mapOfExtVsMIME.put('.css', 'text/css');
            mapOfExtVsMIME.put('.csv', 'text/csv');
            mapOfExtVsMIME.put('.cur', 'application/octet-stream');
            mapOfExtVsMIME.put('.cxx', 'text/plain');
            mapOfExtVsMIME.put('.dat', 'application/octet-stream');
            mapOfExtVsMIME.put('.datasource', 'application/xml');
            mapOfExtVsMIME.put('.dbproj', 'text/plain');
            mapOfExtVsMIME.put('.dcr', 'application/x-director');
            mapOfExtVsMIME.put('.def', 'text/plain');
            mapOfExtVsMIME.put('.deploy', 'application/octet-stream');
            mapOfExtVsMIME.put('.der', 'application/x-x509-ca-cert');
            mapOfExtVsMIME.put('.dgml', 'application/xml');
            mapOfExtVsMIME.put('.dib', 'image/bmp');
            mapOfExtVsMIME.put('.dif', 'video/x-dv');
            mapOfExtVsMIME.put('.dir', 'application/x-director');
            mapOfExtVsMIME.put('.disco', 'text/xml');
            mapOfExtVsMIME.put('.divx', 'video/divx');
            mapOfExtVsMIME.put('.dll', 'application/x-msdownload');
            mapOfExtVsMIME.put('.dll.config', 'text/xml');
            mapOfExtVsMIME.put('.dlm', 'text/dlm');
            mapOfExtVsMIME.put('.doc', 'application/msword');
            mapOfExtVsMIME.put('.docm', 'application/vnd.ms-word.document.macroEnabled.12');
            mapOfExtVsMIME.put('.docx', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document');
            mapOfExtVsMIME.put('.dot', 'application/msword');
            mapOfExtVsMIME.put('.dotm', 'application/vnd.ms-word.template.macroEnabled.12');
            mapOfExtVsMIME.put('.dotx', 'application/vnd.openxmlformats-officedocument.wordprocessingml.template');
            mapOfExtVsMIME.put('.dsp', 'application/octet-stream');
            mapOfExtVsMIME.put('.dsw', 'text/plain');
            mapOfExtVsMIME.put('.dtd', 'text/xml');
            mapOfExtVsMIME.put('.dtsConfig', 'text/xml');
            mapOfExtVsMIME.put('.dv', 'video/x-dv');
            mapOfExtVsMIME.put('.dvi', 'application/x-dvi');
            mapOfExtVsMIME.put('.dwf', 'drawing/x-dwf');
            mapOfExtVsMIME.put('.dwp', 'application/octet-stream');
            mapOfExtVsMIME.put('.dxr', 'application/x-director');
            mapOfExtVsMIME.put('.eml', 'message/rfc822');
            mapOfExtVsMIME.put('.emz', 'application/octet-stream');
            mapOfExtVsMIME.put('.eot', 'application/vnd.ms-fontobject');
            mapOfExtVsMIME.put('.eps', 'application/postscript');
            mapOfExtVsMIME.put('.etl', 'application/etl');
            mapOfExtVsMIME.put('.etx', 'text/x-setext');
            mapOfExtVsMIME.put('.evy', 'application/envoy');
            mapOfExtVsMIME.put('.exe', 'application/octet-stream');
            mapOfExtVsMIME.put('.exe.config', 'text/xml');
            mapOfExtVsMIME.put('.fdf', 'application/vnd.fdf');
            mapOfExtVsMIME.put('.fif', 'application/fractals');
            mapOfExtVsMIME.put('.filters', 'application/xml');
            mapOfExtVsMIME.put('.fla', 'application/octet-stream');
            mapOfExtVsMIME.put('.flac', 'audio/flac');
            mapOfExtVsMIME.put('.flr', 'x-world/x-vrml');
            mapOfExtVsMIME.put('.flv', 'video/x-flv');
            mapOfExtVsMIME.put('.fsscript', 'application/fsharp-script');
            mapOfExtVsMIME.put('.fsx', 'application/fsharp-script');
            mapOfExtVsMIME.put('.generictest', 'application/xml');
            mapOfExtVsMIME.put('.gif', 'image/gif');
            mapOfExtVsMIME.put('.gpx', 'application/gpx+xml');
            mapOfExtVsMIME.put('.group', 'text/x-ms-group');
            mapOfExtVsMIME.put('.gsm', 'audio/x-gsm');
            mapOfExtVsMIME.put('.gtar', 'application/x-gtar');
            mapOfExtVsMIME.put('.gz', 'application/x-gzip');
            mapOfExtVsMIME.put('.h', 'text/plain');
            mapOfExtVsMIME.put('.hdf', 'application/x-hdf');
            mapOfExtVsMIME.put('.hdml', 'text/x-hdml');
            mapOfExtVsMIME.put('.hhc', 'application/x-oleobject');
            mapOfExtVsMIME.put('.hhk', 'application/octet-stream');
            mapOfExtVsMIME.put('.hhp', 'application/octet-stream');
            mapOfExtVsMIME.put('.hlp', 'application/winhlp');
            mapOfExtVsMIME.put('.hpp', 'text/plain');
            mapOfExtVsMIME.put('.hqx', 'application/mac-binhex40');
            mapOfExtVsMIME.put('.hta', 'application/hta');
            mapOfExtVsMIME.put('.htc', 'text/x-component');
            mapOfExtVsMIME.put('.htm', 'text/html');
            mapOfExtVsMIME.put('.html', 'text/html');
            mapOfExtVsMIME.put('.htt', 'text/webviewhtml');
            mapOfExtVsMIME.put('.hxa', 'application/xml');
            mapOfExtVsMIME.put('.hxc', 'application/xml');
            mapOfExtVsMIME.put('.hxd', 'application/octet-stream');
            mapOfExtVsMIME.put('.hxe', 'application/xml');
            mapOfExtVsMIME.put('.hxf', 'application/xml');
            mapOfExtVsMIME.put('.hxh', 'application/octet-stream');
            mapOfExtVsMIME.put('.hxi', 'application/octet-stream');
            mapOfExtVsMIME.put('.hxk', 'application/xml');
            mapOfExtVsMIME.put('.hxq', 'application/octet-stream');
            mapOfExtVsMIME.put('.hxr', 'application/octet-stream');
            mapOfExtVsMIME.put('.hxs', 'application/octet-stream');
            mapOfExtVsMIME.put('.hxt', 'text/html');
            mapOfExtVsMIME.put('.hxv', 'application/xml');
            mapOfExtVsMIME.put('.hxw', 'application/octet-stream');
            mapOfExtVsMIME.put('.hxx', 'text/plain');
            mapOfExtVsMIME.put('.i', 'text/plain');
            mapOfExtVsMIME.put('.ico', 'image/x-icon');
            mapOfExtVsMIME.put('.ics', 'application/octet-stream');
            mapOfExtVsMIME.put('.idl', 'text/plain');
            mapOfExtVsMIME.put('.ief', 'image/ief');
            mapOfExtVsMIME.put('.iii', 'application/x-iphone');
            mapOfExtVsMIME.put('.inc', 'text/plain');
            mapOfExtVsMIME.put('.inf', 'application/octet-stream');
            mapOfExtVsMIME.put('.ini', 'text/plain');
            mapOfExtVsMIME.put('.inl', 'text/plain');
            mapOfExtVsMIME.put('.ins', 'application/x-internet-signup');
            mapOfExtVsMIME.put('.ipa', 'application/x-itunes-ipa');
            mapOfExtVsMIME.put('.ipg', 'application/x-itunes-ipg');
            mapOfExtVsMIME.put('.ipproj', 'text/plain');
            mapOfExtVsMIME.put('.ipsw', 'application/x-itunes-ipsw');
            mapOfExtVsMIME.put('.iqy', 'text/x-ms-iqy');
            mapOfExtVsMIME.put('.isp', 'application/x-internet-signup');
            mapOfExtVsMIME.put('.ite', 'application/x-itunes-ite');
            mapOfExtVsMIME.put('.itlp', 'application/x-itunes-itlp');
            mapOfExtVsMIME.put('.itms', 'application/x-itunes-itms');
            mapOfExtVsMIME.put('.itpc', 'application/x-itunes-itpc');
            mapOfExtVsMIME.put('.IVF', 'video/x-ivf');
            mapOfExtVsMIME.put('.jar', 'application/java-archive');
            mapOfExtVsMIME.put('.java', 'application/octet-stream');
            mapOfExtVsMIME.put('.jck', 'application/liquidmotion');
            mapOfExtVsMIME.put('.jcz', 'application/liquidmotion');
            mapOfExtVsMIME.put('.jfif', 'image/pjpeg');
            mapOfExtVsMIME.put('.jnlp', 'application/x-java-jnlp-file');
            mapOfExtVsMIME.put('.jpb', 'application/octet-stream');
            mapOfExtVsMIME.put('.jpe', 'image/jpeg');
            mapOfExtVsMIME.put('.jpeg', 'image/jpeg');
            mapOfExtVsMIME.put('.jpg', 'image/jpeg');
            mapOfExtVsMIME.put('.js', 'application/javascript');
            mapOfExtVsMIME.put('.json', 'application/json');
            mapOfExtVsMIME.put('.jsx', 'text/jscript');
            mapOfExtVsMIME.put('.jsxbin', 'text/plain');
            mapOfExtVsMIME.put('.latex', 'application/x-latex');
            mapOfExtVsMIME.put('.library-ms', 'application/windows-library+xml');
            mapOfExtVsMIME.put('.lit', 'application/x-ms-reader');
            mapOfExtVsMIME.put('.loadtest', 'application/xml');
            mapOfExtVsMIME.put('.lpk', 'application/octet-stream');
            mapOfExtVsMIME.put('.lsf', 'video/x-la-asf');
            mapOfExtVsMIME.put('.lst', 'text/plain');
            mapOfExtVsMIME.put('.lsx', 'video/x-la-asf');
            mapOfExtVsMIME.put('.lzh', 'application/octet-stream');
            mapOfExtVsMIME.put('.m13', 'application/x-msmediaview');
            mapOfExtVsMIME.put('.m14', 'application/x-msmediaview');
            mapOfExtVsMIME.put('.m1v', 'video/mpeg');
            mapOfExtVsMIME.put('.m2t', 'video/vnd.dlna.mpeg-tts');
            mapOfExtVsMIME.put('.m2ts', 'video/vnd.dlna.mpeg-tts');
            mapOfExtVsMIME.put('.m2v', 'video/mpeg');
            mapOfExtVsMIME.put('.m3u', 'audio/x-mpegurl');
            mapOfExtVsMIME.put('.m3u8', 'audio/x-mpegurl');
            mapOfExtVsMIME.put('.m4a', 'audio/m4a');
            mapOfExtVsMIME.put('.m4b', 'audio/m4b');
            mapOfExtVsMIME.put('.m4p', 'audio/m4p');
            mapOfExtVsMIME.put('.m4r', 'audio/x-m4r');
            mapOfExtVsMIME.put('.m4v', 'video/x-m4v');
            mapOfExtVsMIME.put('.mac', 'image/x-macpaint');
            mapOfExtVsMIME.put('.mak', 'text/plain');
            mapOfExtVsMIME.put('.man', 'application/x-troff-man');
            mapOfExtVsMIME.put('.manifest', 'application/x-ms-manifest');
            mapOfExtVsMIME.put('.map', 'text/plain');
            mapOfExtVsMIME.put('.master', 'application/xml');
            mapOfExtVsMIME.put('.mda', 'application/msaccess');
            mapOfExtVsMIME.put('.mdb', 'application/x-msaccess');
            mapOfExtVsMIME.put('.mde', 'application/msaccess');
            mapOfExtVsMIME.put('.mdp', 'application/octet-stream');
            mapOfExtVsMIME.put('.me', 'application/x-troff-me');
            mapOfExtVsMIME.put('.mfp', 'application/x-shockwave-flash');
            mapOfExtVsMIME.put('.mht', 'message/rfc822');
            mapOfExtVsMIME.put('.mhtml', 'message/rfc822');
            mapOfExtVsMIME.put('.mid', 'audio/mid');
            mapOfExtVsMIME.put('.midi', 'audio/mid');
            mapOfExtVsMIME.put('.mix', 'application/octet-stream');
            mapOfExtVsMIME.put('.mk', 'text/plain');
            mapOfExtVsMIME.put('.mmf', 'application/x-smaf');
            mapOfExtVsMIME.put('.mno', 'text/xml');
            mapOfExtVsMIME.put('.mny', 'application/x-msmoney');
            mapOfExtVsMIME.put('.mod', 'video/mpeg');
            mapOfExtVsMIME.put('.mov', 'video/quicktime');
            mapOfExtVsMIME.put('.movie', 'video/x-sgi-movie');
            mapOfExtVsMIME.put('.mp2', 'video/mpeg');
            mapOfExtVsMIME.put('.mp2v', 'video/mpeg');
            mapOfExtVsMIME.put('.mp3', 'audio/mpeg');
            mapOfExtVsMIME.put('.mp4', 'video/mp4');
            mapOfExtVsMIME.put('.mp4v', 'video/mp4');
            mapOfExtVsMIME.put('.mpa', 'video/mpeg');
            mapOfExtVsMIME.put('.mpe', 'video/mpeg');
            mapOfExtVsMIME.put('.mpeg', 'video/mpeg');
            mapOfExtVsMIME.put('.mpf', 'application/vnd.ms-mediapackage');
            mapOfExtVsMIME.put('.mpg', 'video/mpeg');
            mapOfExtVsMIME.put('.mpp', 'application/vnd.ms-project');
            mapOfExtVsMIME.put('.mpv2', 'video/mpeg');
            mapOfExtVsMIME.put('.mqv', 'video/quicktime');
            mapOfExtVsMIME.put('.ms', 'application/x-troff-ms');
            mapOfExtVsMIME.put('.msi', 'application/octet-stream');
            mapOfExtVsMIME.put('.mso', 'application/octet-stream');
            mapOfExtVsMIME.put('.mts', 'video/vnd.dlna.mpeg-tts');
            mapOfExtVsMIME.put('.mtx', 'application/xml');
            mapOfExtVsMIME.put('.mvb', 'application/x-msmediaview');
            mapOfExtVsMIME.put('.mvc', 'application/x-miva-compiled');
            mapOfExtVsMIME.put('.mxp', 'application/x-mmxp');
            mapOfExtVsMIME.put('.nc', 'application/x-netcdf');
            mapOfExtVsMIME.put('.nsc', 'video/x-ms-asf');
            mapOfExtVsMIME.put('.nws', 'message/rfc822');
            mapOfExtVsMIME.put('.ocx', 'application/octet-stream');
            mapOfExtVsMIME.put('.oda', 'application/oda');
            mapOfExtVsMIME.put('.odb', 'application/vnd.oasis.opendocument.database');
            mapOfExtVsMIME.put('.odc', 'application/vnd.oasis.opendocument.chart');
            mapOfExtVsMIME.put('.odf', 'application/vnd.oasis.opendocument.formula');
            mapOfExtVsMIME.put('.odg', 'application/vnd.oasis.opendocument.graphics');
            mapOfExtVsMIME.put('.odh', 'text/plain');
            mapOfExtVsMIME.put('.odi', 'application/vnd.oasis.opendocument.image');
            mapOfExtVsMIME.put('.odl', 'text/plain');
            mapOfExtVsMIME.put('.odm', 'application/vnd.oasis.opendocument.text-master');
            mapOfExtVsMIME.put('.odp', 'application/vnd.oasis.opendocument.presentation');
            mapOfExtVsMIME.put('.ods', 'application/vnd.oasis.opendocument.spreadsheet');
            mapOfExtVsMIME.put('.odt', 'application/vnd.oasis.opendocument.text');
            mapOfExtVsMIME.put('.oga', 'audio/ogg');
            mapOfExtVsMIME.put('.ogg', 'audio/ogg');
            mapOfExtVsMIME.put('.ogv', 'video/ogg');
            mapOfExtVsMIME.put('.ogx', 'application/ogg');
            mapOfExtVsMIME.put('.one', 'application/onenote');
            mapOfExtVsMIME.put('.onea', 'application/onenote');
            mapOfExtVsMIME.put('.onepkg', 'application/onenote');
            mapOfExtVsMIME.put('.onetmp', 'application/onenote');
            mapOfExtVsMIME.put('.onetoc', 'application/onenote');
            mapOfExtVsMIME.put('.onetoc2', 'application/onenote');
            mapOfExtVsMIME.put('.opus', 'audio/ogg');
            mapOfExtVsMIME.put('.orderedtest', 'application/xml');
            mapOfExtVsMIME.put('.osdx', 'application/opensearchdescription+xml');
            mapOfExtVsMIME.put('.otf', 'application/font-sfnt');
            mapOfExtVsMIME.put('.otg', 'application/vnd.oasis.opendocument.graphics-template');
            mapOfExtVsMIME.put('.oth', 'application/vnd.oasis.opendocument.text-web');
            mapOfExtVsMIME.put('.otp', 'application/vnd.oasis.opendocument.presentation-template');
            mapOfExtVsMIME.put('.ots', 'application/vnd.oasis.opendocument.spreadsheet-template');
            mapOfExtVsMIME.put('.ott', 'application/vnd.oasis.opendocument.text-template');
            mapOfExtVsMIME.put('.oxt', 'application/vnd.openofficeorg.extension');
            mapOfExtVsMIME.put('.p10', 'application/pkcs10');
            mapOfExtVsMIME.put('.p12', 'application/x-pkcs12');
            mapOfExtVsMIME.put('.p7b', 'application/x-pkcs7-certificates');
            mapOfExtVsMIME.put('.p7c', 'application/pkcs7-mime');
            mapOfExtVsMIME.put('.p7m', 'application/pkcs7-mime');
            mapOfExtVsMIME.put('.p7r', 'application/x-pkcs7-certreqresp');
            mapOfExtVsMIME.put('.p7s', 'application/pkcs7-signature');
            mapOfExtVsMIME.put('.pbm', 'image/x-portable-bitmap');
            mapOfExtVsMIME.put('.pcast', 'application/x-podcast');
            mapOfExtVsMIME.put('.pct', 'image/pict');
            mapOfExtVsMIME.put('.pcx', 'application/octet-stream');
            mapOfExtVsMIME.put('.pcz', 'application/octet-stream');
            mapOfExtVsMIME.put('.pdf', 'application/pdf');
            mapOfExtVsMIME.put('.pfb', 'application/octet-stream');
            mapOfExtVsMIME.put('.pfm', 'application/octet-stream');
            mapOfExtVsMIME.put('.pfx', 'application/x-pkcs12');
            mapOfExtVsMIME.put('.pgm', 'image/x-portable-graymap');
            mapOfExtVsMIME.put('.pic', 'image/pict');
            mapOfExtVsMIME.put('.pict', 'image/pict');
            mapOfExtVsMIME.put('.pkgdef', 'text/plain');
            mapOfExtVsMIME.put('.pkgundef', 'text/plain');
            mapOfExtVsMIME.put('.pko', 'application/vnd.ms-pki.pko');
            mapOfExtVsMIME.put('.pls', 'audio/scpls');
            mapOfExtVsMIME.put('.pma', 'application/x-perfmon');
            mapOfExtVsMIME.put('.pmc', 'application/x-perfmon');
            mapOfExtVsMIME.put('.pml', 'application/x-perfmon');
            mapOfExtVsMIME.put('.pmr', 'application/x-perfmon');
            mapOfExtVsMIME.put('.pmw', 'application/x-perfmon');
            mapOfExtVsMIME.put('.png', 'image/png');
            mapOfExtVsMIME.put('.pnm', 'image/x-portable-anymap');
            mapOfExtVsMIME.put('.pnt', 'image/x-macpaint');
            mapOfExtVsMIME.put('.pntg', 'image/x-macpaint');
            mapOfExtVsMIME.put('.pnz', 'image/png');
            mapOfExtVsMIME.put('.pot', 'application/vnd.ms-powerpoint');
            mapOfExtVsMIME.put('.potm', 'application/vnd.ms-powerpoint.template.macroEnabled.12');
            mapOfExtVsMIME.put('.potx', 'application/vnd.openxmlformats-officedocument.presentationml.template');
            mapOfExtVsMIME.put('.ppa', 'application/vnd.ms-powerpoint');
            mapOfExtVsMIME.put('.ppam', 'application/vnd.ms-powerpoint.addin.macroEnabled.12');
            mapOfExtVsMIME.put('.ppm', 'image/x-portable-pixmap');
            mapOfExtVsMIME.put('.pps', 'application/vnd.ms-powerpoint');
            mapOfExtVsMIME.put('.ppsm', 'application/vnd.ms-powerpoint.slideshow.macroEnabled.12');
            mapOfExtVsMIME.put('.ppsx', 'application/vnd.openxmlformats-officedocument.presentationml.slideshow');
            mapOfExtVsMIME.put('.ppt', 'application/vnd.ms-powerpoint');
            mapOfExtVsMIME.put('.pptm', 'application/vnd.ms-powerpoint.presentation.macroEnabled.12');
            mapOfExtVsMIME.put('.pptx', 'application/vnd.openxmlformats-officedocument.presentationml.presentation');
            mapOfExtVsMIME.put('.prf', 'application/pics-rules');
            mapOfExtVsMIME.put('.prm', 'application/octet-stream');
            mapOfExtVsMIME.put('.prx', 'application/octet-stream');
            mapOfExtVsMIME.put('.ps', 'application/postscript');
            mapOfExtVsMIME.put('.psc1', 'application/PowerShell');
            mapOfExtVsMIME.put('.psd', 'application/octet-stream');
            mapOfExtVsMIME.put('.psess', 'application/xml');
            mapOfExtVsMIME.put('.psm', 'application/octet-stream');
            mapOfExtVsMIME.put('.psp', 'application/octet-stream');
            mapOfExtVsMIME.put('.pub', 'application/x-mspublisher');
            mapOfExtVsMIME.put('.pwz', 'application/vnd.ms-powerpoint');
            mapOfExtVsMIME.put('.qht', 'text/x-html-insertion');
            mapOfExtVsMIME.put('.qhtm', 'text/x-html-insertion');
            mapOfExtVsMIME.put('.qt', 'video/quicktime');
            mapOfExtVsMIME.put('.qti', 'image/x-quicktime');
            mapOfExtVsMIME.put('.qtif', 'image/x-quicktime');
            mapOfExtVsMIME.put('.qtl', 'application/x-quicktimeplayer');
            mapOfExtVsMIME.put('.qxd', 'application/octet-stream');
            mapOfExtVsMIME.put('.ra', 'audio/x-pn-realaudio');
            mapOfExtVsMIME.put('.ram', 'audio/x-pn-realaudio');
            mapOfExtVsMIME.put('.rar', 'application/x-rar-compressed');
            mapOfExtVsMIME.put('.ras', 'image/x-cmu-raster');
            mapOfExtVsMIME.put('.rat', 'application/rat-file');
            mapOfExtVsMIME.put('.rc', 'text/plain');
            mapOfExtVsMIME.put('.rc2', 'text/plain');
            mapOfExtVsMIME.put('.rct', 'text/plain');
            mapOfExtVsMIME.put('.rdlc', 'application/xml');
            mapOfExtVsMIME.put('.reg', 'text/plain');
            mapOfExtVsMIME.put('.resx', 'application/xml');
            mapOfExtVsMIME.put('.rf', 'image/vnd.rn-realflash');
            mapOfExtVsMIME.put('.rgb', 'image/x-rgb');
            mapOfExtVsMIME.put('.rgs', 'text/plain');
            mapOfExtVsMIME.put('.rm', 'application/vnd.rn-realmedia');
            mapOfExtVsMIME.put('.rmi', 'audio/mid');
            mapOfExtVsMIME.put('.rmp', 'application/vnd.rn-rn_music_package');
            mapOfExtVsMIME.put('.roff', 'application/x-troff');
            mapOfExtVsMIME.put('.rpm', 'audio/x-pn-realaudio-plugin');
            mapOfExtVsMIME.put('.rqy', 'text/x-ms-rqy');
            mapOfExtVsMIME.put('.rtf', 'application/rtf');
            mapOfExtVsMIME.put('.rtx', 'text/richtext');
            mapOfExtVsMIME.put('.ruleset', 'application/xml');
            mapOfExtVsMIME.put('.s', 'text/plain');
            mapOfExtVsMIME.put('.safariextz', 'application/x-safari-safariextz');
            mapOfExtVsMIME.put('.scd', 'application/x-msschedule');
            mapOfExtVsMIME.put('.scr', 'text/plain');
            mapOfExtVsMIME.put('.sct', 'text/scriptlet');
            mapOfExtVsMIME.put('.sd2', 'audio/x-sd2');
            mapOfExtVsMIME.put('.sdp', 'application/sdp');
            mapOfExtVsMIME.put('.sea', 'application/octet-stream');
            mapOfExtVsMIME.put('.searchConnector-ms', 'application/windows-search-connector+xml');
            mapOfExtVsMIME.put('.setpay', 'application/set-payment-initiation');
            mapOfExtVsMIME.put('.setreg', 'application/set-registration-initiation');
            mapOfExtVsMIME.put('.settings', 'application/xml');
            mapOfExtVsMIME.put('.sgimb', 'application/x-sgimb');
            mapOfExtVsMIME.put('.sgml', 'text/sgml');
            mapOfExtVsMIME.put('.sh', 'application/x-sh');
            mapOfExtVsMIME.put('.shar', 'application/x-shar');
            mapOfExtVsMIME.put('.shtml', 'text/html');
            mapOfExtVsMIME.put('.sit', 'application/x-stuffit');
            mapOfExtVsMIME.put('.sitemap', 'application/xml');
            mapOfExtVsMIME.put('.skin', 'application/xml');
            mapOfExtVsMIME.put('.sldm', 'application/vnd.ms-powerpoint.slide.macroEnabled.12');
            mapOfExtVsMIME.put('.sldx', 'application/vnd.openxmlformats-officedocument.presentationml.slide');
            mapOfExtVsMIME.put('.slk', 'application/vnd.ms-excel');
            mapOfExtVsMIME.put('.sln', 'text/plain');
            mapOfExtVsMIME.put('.slupkg-ms', 'application/x-ms-license');
            mapOfExtVsMIME.put('.smd', 'audio/x-smd');
            mapOfExtVsMIME.put('.smi', 'application/octet-stream');
            mapOfExtVsMIME.put('.smx', 'audio/x-smd');
            mapOfExtVsMIME.put('.smz', 'audio/x-smd');
            mapOfExtVsMIME.put('.snd', 'audio/basic');
            mapOfExtVsMIME.put('.snippet', 'application/xml');
            mapOfExtVsMIME.put('.snp', 'application/octet-stream');
            mapOfExtVsMIME.put('.sol', 'text/plain');
            mapOfExtVsMIME.put('.sor', 'text/plain');
            mapOfExtVsMIME.put('.spc', 'application/x-pkcs7-certificates');
            mapOfExtVsMIME.put('.spl', 'application/futuresplash');
            mapOfExtVsMIME.put('.spx', 'audio/ogg');
            mapOfExtVsMIME.put('.src', 'application/x-wais-source');
            mapOfExtVsMIME.put('.srf', 'text/plain');
            mapOfExtVsMIME.put('.SSISDeploymentManifest', 'text/xml');
            mapOfExtVsMIME.put('.ssm', 'application/streamingmedia');
            mapOfExtVsMIME.put('.sst', 'application/vnd.ms-pki.certstore');
            mapOfExtVsMIME.put('.stl', 'application/vnd.ms-pki.stl');
            mapOfExtVsMIME.put('.sv4cpio', 'application/x-sv4cpio');
            mapOfExtVsMIME.put('.sv4crc', 'application/x-sv4crc');
            mapOfExtVsMIME.put('.svc', 'application/xml');
            mapOfExtVsMIME.put('.svg', 'image/svg+xml');
            mapOfExtVsMIME.put('.swf', 'application/x-shockwave-flash');
            mapOfExtVsMIME.put('.step', 'application/step');
            mapOfExtVsMIME.put('.stp', 'application/step');
            mapOfExtVsMIME.put('.t', 'application/x-troff');
            mapOfExtVsMIME.put('.tar', 'application/x-tar');
            mapOfExtVsMIME.put('.tcl', 'application/x-tcl');
            mapOfExtVsMIME.put('.testrunconfig', 'application/xml');
            mapOfExtVsMIME.put('.testsettings', 'application/xml');
            mapOfExtVsMIME.put('.tex', 'application/x-tex');
            mapOfExtVsMIME.put('.texi', 'application/x-texinfo');
            mapOfExtVsMIME.put('.texinfo', 'application/x-texinfo');
            mapOfExtVsMIME.put('.tgz', 'application/x-compressed');
            mapOfExtVsMIME.put('.thmx', 'application/vnd.ms-officetheme');
            mapOfExtVsMIME.put('.thn', 'application/octet-stream');
            mapOfExtVsMIME.put('.tif', 'image/tiff');
            mapOfExtVsMIME.put('.tiff', 'image/tiff');
            mapOfExtVsMIME.put('.tlh', 'text/plain');
            mapOfExtVsMIME.put('.tli', 'text/plain');
            mapOfExtVsMIME.put('.toc', 'application/octet-stream');
            mapOfExtVsMIME.put('.tr', 'application/x-troff');
            mapOfExtVsMIME.put('.trm', 'application/x-msterminal');
            mapOfExtVsMIME.put('.trx', 'application/xml');
            mapOfExtVsMIME.put('.ts', 'video/vnd.dlna.mpeg-tts');
            mapOfExtVsMIME.put('.tsv', 'text/tab-separated-values');
            mapOfExtVsMIME.put('.ttf', 'application/font-sfnt');
            mapOfExtVsMIME.put('.tts', 'video/vnd.dlna.mpeg-tts');
            mapOfExtVsMIME.put('.txt', 'text/plain');
            mapOfExtVsMIME.put('.u32', 'application/octet-stream');
            mapOfExtVsMIME.put('.uls', 'text/iuls');
            mapOfExtVsMIME.put('.user', 'text/plain');
            mapOfExtVsMIME.put('.ustar', 'application/x-ustar');
            mapOfExtVsMIME.put('.vb', 'text/plain');
            mapOfExtVsMIME.put('.vbdproj', 'text/plain');
            mapOfExtVsMIME.put('.vbk', 'video/mpeg');
            mapOfExtVsMIME.put('.vbproj', 'text/plain');
            mapOfExtVsMIME.put('.vbs', 'text/vbscript');
            mapOfExtVsMIME.put('.vcf', 'text/x-vcard');
            mapOfExtVsMIME.put('.vcproj', 'application/xml');
            mapOfExtVsMIME.put('.vcs', 'text/plain');
            mapOfExtVsMIME.put('.vcxproj', 'application/xml');
            mapOfExtVsMIME.put('.vddproj', 'text/plain');
            mapOfExtVsMIME.put('.vdp', 'text/plain');
            mapOfExtVsMIME.put('.vdproj', 'text/plain');
            mapOfExtVsMIME.put('.vdx', 'application/vnd.ms-visio.viewer');
            mapOfExtVsMIME.put('.vml', 'text/xml');
            mapOfExtVsMIME.put('.vscontent', 'application/xml');
            mapOfExtVsMIME.put('.vsct', 'text/xml');
            mapOfExtVsMIME.put('.vsd', 'application/vnd.visio');
            mapOfExtVsMIME.put('.vsi', 'application/ms-vsi');
            mapOfExtVsMIME.put('.vsix', 'application/vsix');
            mapOfExtVsMIME.put('.vsixlangpack', 'text/xml');
            mapOfExtVsMIME.put('.vsixmanifest', 'text/xml');
            mapOfExtVsMIME.put('.vsmdi', 'application/xml');
            mapOfExtVsMIME.put('.vspscc', 'text/plain');
            mapOfExtVsMIME.put('.vss', 'application/vnd.visio');
            mapOfExtVsMIME.put('.vsscc', 'text/plain');
            mapOfExtVsMIME.put('.vssettings', 'text/xml');
            mapOfExtVsMIME.put('.vssscc', 'text/plain');
            mapOfExtVsMIME.put('.vst', 'application/vnd.visio');
            mapOfExtVsMIME.put('.vstemplate', 'text/xml');
            mapOfExtVsMIME.put('.vsto', 'application/x-ms-vsto');
            mapOfExtVsMIME.put('.vsw', 'application/vnd.visio');
            mapOfExtVsMIME.put('.vsx', 'application/vnd.visio');
            mapOfExtVsMIME.put('.vtx', 'application/vnd.visio');
            mapOfExtVsMIME.put('.wav', 'audio/wav');
            mapOfExtVsMIME.put('.wave', 'audio/wav');
            mapOfExtVsMIME.put('.wax', 'audio/x-ms-wax');
            mapOfExtVsMIME.put('.wbk', 'application/msword');
            mapOfExtVsMIME.put('.wbmp', 'image/vnd.wap.wbmp');
            mapOfExtVsMIME.put('.wcm', 'application/vnd.ms-works');
            mapOfExtVsMIME.put('.wdb', 'application/vnd.ms-works');
            mapOfExtVsMIME.put('.wdp', 'image/vnd.ms-photo');
            mapOfExtVsMIME.put('.webarchive', 'application/x-safari-webarchive');
            mapOfExtVsMIME.put('.webm', 'video/webm');
            mapOfExtVsMIME.put('.webp', 'image/webp');
            mapOfExtVsMIME.put('.webtest', 'application/xml');
            mapOfExtVsMIME.put('.wiq', 'application/xml');
            mapOfExtVsMIME.put('.wiz', 'application/msword');
            mapOfExtVsMIME.put('.wks', 'application/vnd.ms-works');
            mapOfExtVsMIME.put('.WLMP', 'application/wlmoviemaker');
            mapOfExtVsMIME.put('.wlpginstall', 'application/x-wlpg-detect');
            mapOfExtVsMIME.put('.wlpginstall3', 'application/x-wlpg3-detect');
            mapOfExtVsMIME.put('.wm', 'video/x-ms-wm');
            mapOfExtVsMIME.put('.wma', 'audio/x-ms-wma');
            mapOfExtVsMIME.put('.wmd', 'application/x-ms-wmd');
            mapOfExtVsMIME.put('.wmf', 'application/x-msmetafile');
            mapOfExtVsMIME.put('.wml', 'text/vnd.wap.wml');
            mapOfExtVsMIME.put('.wmlc', 'application/vnd.wap.wmlc');
            mapOfExtVsMIME.put('.wmls', 'text/vnd.wap.wmlscript');
            mapOfExtVsMIME.put('.wmlsc', 'application/vnd.wap.wmlscriptc');
            mapOfExtVsMIME.put('.wmp', 'video/x-ms-wmp');
            mapOfExtVsMIME.put('.wmv', 'video/x-ms-wmv');
            mapOfExtVsMIME.put('.wmx', 'video/x-ms-wmx');
            mapOfExtVsMIME.put('.wmz', 'application/x-ms-wmz');
            mapOfExtVsMIME.put('.woff', 'application/font-woff');
            mapOfExtVsMIME.put('.wpl', 'application/vnd.ms-wpl');
            mapOfExtVsMIME.put('.wps', 'application/vnd.ms-works');
            mapOfExtVsMIME.put('.wri', 'application/x-mswrite');
            mapOfExtVsMIME.put('.wrl', 'x-world/x-vrml');
            mapOfExtVsMIME.put('.wrz', 'x-world/x-vrml');
            mapOfExtVsMIME.put('.wsc', 'text/scriptlet');
            mapOfExtVsMIME.put('.wsdl', 'text/xml');
            mapOfExtVsMIME.put('.wvx', 'video/x-ms-wvx');
            mapOfExtVsMIME.put('.x', 'application/directx');
            mapOfExtVsMIME.put('.xaf', 'x-world/x-vrml');
            mapOfExtVsMIME.put('.xaml', 'application/xaml+xml');
            mapOfExtVsMIME.put('.xap', 'application/x-silverlight-app');
            mapOfExtVsMIME.put('.xbap', 'application/x-ms-xbap');
            mapOfExtVsMIME.put('.xbm', 'image/x-xbitmap');
            mapOfExtVsMIME.put('.xdr', 'text/plain');
            mapOfExtVsMIME.put('.xht', 'application/xhtml+xml');
            mapOfExtVsMIME.put('.xhtml', 'application/xhtml+xml');
            mapOfExtVsMIME.put('.xla', 'application/vnd.ms-excel');
            mapOfExtVsMIME.put('.xlam', 'application/vnd.ms-excel.addin.macroEnabled.12');
            mapOfExtVsMIME.put('.xlc', 'application/vnd.ms-excel');
            mapOfExtVsMIME.put('.xld', 'application/vnd.ms-excel');
            mapOfExtVsMIME.put('.xlk', 'application/vnd.ms-excel');
            mapOfExtVsMIME.put('.xll', 'application/vnd.ms-excel');
            mapOfExtVsMIME.put('.xlm', 'application/vnd.ms-excel');
            mapOfExtVsMIME.put('.xls', 'application/vnd.ms-excel');
            mapOfExtVsMIME.put('.xlsb', 'application/vnd.ms-excel.sheet.binary.macroEnabled.12');
            mapOfExtVsMIME.put('.xlsm', 'application/vnd.ms-excel.sheet.macroEnabled.12');
            mapOfExtVsMIME.put('.xlsx', 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
            mapOfExtVsMIME.put('.xlt', 'application/vnd.ms-excel');
            mapOfExtVsMIME.put('.xltm', 'application/vnd.ms-excel.template.macroEnabled.12');
            mapOfExtVsMIME.put('.xltx', 'application/vnd.openxmlformats-officedocument.spreadsheetml.template');
            mapOfExtVsMIME.put('.xlw', 'application/vnd.ms-excel');
            mapOfExtVsMIME.put('.xml', 'text/xml');
            mapOfExtVsMIME.put('.xmta', 'application/xml');
            mapOfExtVsMIME.put('.xof', 'x-world/x-vrml');
            mapOfExtVsMIME.put('.XOML', 'text/plain');
            mapOfExtVsMIME.put('.xpm', 'image/x-xpixmap');
            mapOfExtVsMIME.put('.xps', 'application/vnd.ms-xpsdocument');
            mapOfExtVsMIME.put('.xrm-ms', 'text/xml');
            mapOfExtVsMIME.put('.xsc', 'application/xml');
            mapOfExtVsMIME.put('.xsd', 'text/xml');
            mapOfExtVsMIME.put('.xsf', 'text/xml');
            mapOfExtVsMIME.put('.xsl', 'text/xml');
            mapOfExtVsMIME.put('.xslt', 'text/xml');
            mapOfExtVsMIME.put('.xsn', 'application/octet-stream');
            mapOfExtVsMIME.put('.xss', 'application/xml');
            mapOfExtVsMIME.put('.xspf', 'application/xspf+xml');
            mapOfExtVsMIME.put('.xtp', 'application/octet-stream');
            mapOfExtVsMIME.put('.xwd', 'image/x-xwindowdump');
            mapOfExtVsMIME.put('.z', 'application/x-compress');
            mapOfExtVsMIME.put('.zip', 'application/zip'); 
        return mapOfExtVsMIME.get('.' + fileExt);
    }
}