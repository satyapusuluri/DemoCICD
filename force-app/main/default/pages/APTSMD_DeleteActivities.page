<apex:page id="VFPage" controller="APTSMD_DeleteActivitiesController"  lightningStylesheets="true">
    <script>
        function showSpinner(){
            document.getElementById('spinner').style.display = 'block';
            return;
        }
        function callDeleteAction(){
            Visualforce.remoting.Manager.invokeAction(
                '{!$RemoteAction.APTSMD_DeleteActivitiesController.massDeleteActivities}', 
                function(result, event){
                    if(result == 0){
                        document.getElementById('spinner').style.display = 'none';
                        alert('All Records are deleted Successfully');
                        location.reload();
                       
                    }
                    else{
                        callDeleteAction();
                    }
                }, 
                {escape: true}
            );
            
             
        }
       
    </script>
      <apex:form id="VFForm">
    
    <apex:pageBlock title="Mass delete activities generated by CLM,CPQ actions">
        <apex:pageMessages />
        <apex:outputPanel id="refreshPanel">
            <span style="color:red;font-weight:bold;">
                <br/>
                <apex:outputPanel id="thePanel1" >This will delete all of the activities in the system where the Subject = 'Get Internal Signatures' and 'Get External Signatures' and 'Scan &amp; Attach Agreement'</apex:outputPanel>
                
                <br/>
                <table style="margin-left:2%; height:50px; width:100px;">
                    <tr>
                        <td>Task</td>
                         <td>:</td>
                        <td>{!CountTask2}</td>
                    </tr>
                    <tr>
                        <td>Event</td>
                        <td>:</td>
                        <td>{!CountEvent2}</td>
                    </tr>
                </table>
            </span>
        </apex:outputPanel>
        
        <br/><br/><br/>
        <apex:pageBlockButtons location="bottom">
            <apex:commandButton value="Mass Delete Activities" rerender="refreshPanel" onclick="showSpinner();callDeleteAction();"/>
            <apex:commandButton value="Cancel" action="{!cancel}"/>  
            
        </apex:pageBlockButtons>  
        
        <center><img src="{!$Resource.APTSMD_Loading}" style="display:none;position: absolute;margin-left: 42%;z-index: 999999999999; height: 80px;" id="spinner"/></center>
    </apex:pageBlock>
  </apex:form> 
</apex:page>